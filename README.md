### Repository content description

This repository contains the code described in the **Spotting Culex pipiens from Satellite: modeling environmental suitability in central Italy with Sentinel-2 and Deep Learning methods** scientific paper for Earth Observation (EO) data download and preprocessing. 

 * MODIS sample data is provided

 * Sentinel-2 sample data is NOT provided due to its size (about 600/1200 MB). Running the 01b_DOWNLOAD_S2_CDSE.py script you will download a proper Sentinel-2 archive for testing. A Copernicus Data Space Ecosystem account is **required** (register [here](https://tinyurl.com/yw69kbuj)).

 * The python script used to download the Sentinel-2 data described in the paper relies on the [SentinelSat](https://sentinelsat.readthedocs.io/en/stable/index.html) package, which is **no longer functional** since the Copernicus SciHub was permanently closed. Read the project development team's announcement [here](https://github.com/sentinelsat/sentinelsat/blob/main/README.rst). Nonetheless, we have included the sentinelsat based search&download script in the repository for completeness and informational purposes (01a_DOWNLOAD_S2.py), but we did not include the package in the *requirements.txt* file because it would be pointless.

 * The *.tif* crops generated by this collection of scripts are the input data used to feed the ML model described in the scientific paper. The ML model codebase is available [here](https://github.com/loribonna/release_frontiers_wnv).

> [!NOTE]
> ##### Required Skills
> To use the content of this repository effectively, readers are expected to have basic knowledge of the Python programming language and virtual environment creation. It is strongly recommended that users acquire these skills before utilizing the materials provided here. Please note that the inability to execute the code correctly due to a lack of skills may result in limited effectiveness and accuracy of the obtained results.
   
### Prepare the environment

##### VS Code DevContainer
The most convenient way to run the scripts is to use the provided [devcontainer](https://code.visualstudio.com/docs/devcontainers/containers), which automatically sets up the python environment required for the code to function properly. You will need:
 * Docker Desktop (or Rancher)
 * Visual Studio Code with the *Dev Containers* extension installed.

After starting Docker on your machine, clone this repository on your computer and open the obtained folder within Visual Studio Code. The editor will recognize the *.devcontainer/devcontainer.json* configuration file and initiate the environment, installing by itself the packages listed in *requirements.txt* file.

##### Other methods
If you prefer not to use the devcontainer, you can install the python environment as you like (Anaconda, Pipenv, Pyenv, Poetry, etc.). Always refer to the *requirements.txt* file for the list of required packages.

 ### Run the EO pipeline
 Follow these steps to run the EO data download and preprocessing pipeline:
```
# move to the scripts folder
cd src/EO/script

# download the sample Sentinel-2 archive (you need to create a CDSE account first! The download script will ask you for your credentials)
/bin/python3 01b_DOWNLOAD_S2_CDSE.py

# extract the archive to SAFE folder
/bin/python3 02_EXTRACT_S2_20M.py

# create Sentinel-2 crops
/bin/python3 03_CROP_NORM_S2_GDAL.py

# create MODIS LSTD/LSTN crops
/bin/python3 04_CROP_RESIZE_MODIS.py

```

All the needed folders not already included in this repo will be automatically created during the process.
